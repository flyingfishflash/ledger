plugins {
    id 'com.diffplug.spotless' version '5.8.2'
    id 'fr.brouillard.oss.gradle.jgitver' version '0.10.0-rc03'
    id 'com.geoffgranum.gradle-conventional-changelog' version '0.3.1'
}

subprojects {
    ext {
        googleJavaFormatVersion = "1.9"
    }
}

task finalize {
    doLast {
        println(version)
    }
}

task writeVersion {
    outputs.upToDateWhen { false }
    new File(projectDir, "version").text = version
}

build {
    finalizedBy(finalize)
}

changelog {
    file 'CHANGELOG.md'

    appName rootProject.name

    versionNum version.toString()

    repoUrl 'https://github.com/rollenwiese/ledger'

    trackerUrl 'https://github.com/rollenwiese/ledger'

    //match '^fix|^feat|^fix|^perf|^refactor|^docs|BREAKING' //default
    match '^fix|^feat|^fix|^chore|^docs|^style|^refactor|^perf|^test|BREAKING'
}