plugins {
    id 'com.diffplug.spotless' version '6.4.1'
    id "com.github.ben-manes.versions" version '0.42.0'
}

ext {
}

subprojects {
    ext {
        googleJavaFormatVersion = "1.15.0"
        scmVersion = "./scripts/version.sh version".execute().text.trim()
        scmCommit = "./scripts/version.sh commit".execute().text.trim()
        ciPlatform = "./scripts/version.sh ci-platform".execute().text.trim()
        ciPipelineId = "./scripts/version.sh ci-pipeline-id".execute().text.trim()
    }
}

tasks.register("printVersionScriptOutput") {
    doLast {
        project.exec {
            commandLine("./scripts/build/version.sh",  "all")
        }
    }
}

/*
build {
    finalizedBy aTask
}
*/

spotless {
    format 'json', {
        target '*.json'
        prettier()
    }

    format 'misc', {
        target '*.gradle', '*.md', '*.xml', '.gitignore'
        trimTrailingWhitespace()
        indentWithSpaces()
        endWithNewline()
    }

    format 'yaml', {
        target '*.yml'
        prettier()
    }
}
